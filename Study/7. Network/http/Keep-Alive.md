Keep-Alive 일반 헤더는 송신자가 연결에 대한 타임아웃과 요청 최대 개수를 어떻게 정했는지에 대해 알려준다.
Keep-Alive 기능은 클라이언트와 서버 간 요청 및 응답 과정을 효율적으로 유지하기 위해 사용된다.
Keep-Alive를 활성화하면 하나의 TCP 연결을 여러 번 재사용하며 응답과 요청을 수행할 수 있다.

> [!note] 참고
> `Connection` 헤더는 이 헤더를 위해 어떤 의미든 갖도록 "keep-alive"로 설정되어야 한다. 또한, `Connection`과 `Keep-Alive`는 HTTP/2에서 무시된다.
> 연결 관리는 해당 프로토콜 내에서 다른 메커니즘에 의해 처리된다.

## 사용 형태

```
Keep-Alive: parameters
```

### 파라미터
쉼표로 구분된 파라미터 목록으로, 각각 등호(`=`)로 구분되는 식별자와 값으로 구성된다. 다음은 사용 가능한 식별자들이다.
- `timeout`: 유휴 연결이 계속 열려 있어야 하는 최소한의 시간(초 단위)를 가리킨다.
	- keep-alive TCP 메시지가 전송 계층에 설정되지 않는다면 TCP 타임아웃 이상의 타임아웃은 무시된다.
- `max`: 연결이 닫히기 이전에 전송될 수 있는 최대 요청 수를 가리킨다.
	- 만약 0이 아니라면, 해당 값은 다음 응답 내에서 다른 요청이 전송될 것이므로 비-파이프라인 연결의 경우 무시된다.
	- HTTP 파이프라인은 파이프라이닝을 제한하는 용도로 해당 값을 사용할 수 있다.

#### 예제
```
HTTP/1.1 200 OK
Connection: Keep-Alive
Content-Encoding: gzip
Content-Type: text/html; charset=utf-8
Date: Thu, 11 Aug 2016 15:23:13 GMT
Keep-Alive: timeout=5, max=1000
Last-Modified: Mon, 25 Jul 2016 04:32:39 GMT
Server: Apache

(body)
```

## 사용 이점

keep-alive가 없으면 클라이언트와 서버는 각 요청과 응답에 대해 매번 새로운 TCP 연결을 생성하고 닫아야 한다. 이 방식은 네트워크 리소스가 비효율적으로 사용된다.
반면 keep-alive를 사용하면 단일 TCP 연결에서 여러 요청 응답이 이루어지기 때문에 네트워크 지연 시간이 줄어들고 웹 사이트 성능이 좋아진다.

초기 HTTP/1.0 프로토콜에서는 각 HTTP 요청에 대해 매번 TCP 연결을 새로 생성해야 했기 때문에 위에서 언급한 문제들이 존재했다. 이를 해결하기 위해 HTTP/1.1 프로토콜에 해당 기능이 도입됐다.

![[Pasted image 20250325155158.png]]
위 이미지는 4개의 트랜잭션에 대해 연속적으로 4개의 커넥션을 생성하여 처리하는 방식과 하나의 지속 커넥션으로만 처리하는 방식을 비교한 이미지이다.

후자에서는 커넥션을 맺고 끊는 데 작업이 없어졌기 때문에 시간이 단축되었다.

## 정리

HTTP 프로토콜은 클라이언트가 서버에 요청을 보내고 서버가 응답을 보내는 동안에만 연결을 유지한다. 이후에는 연결이 종료되고 다시 연결을 맺어야 한다.

하지만 Keep Alive 를 사용하면 클라이언트와 서버 간의 연결을 유지할 수 있다. 이는 웹 페이지를 로드하는 데 필요한 추가 연결 설정 시간을 줄여 성능을 향상시킬 수 있다.